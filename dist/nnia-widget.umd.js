!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["react","react-dom"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).React,e.ReactDOM)}(this,function(e,t){"use strict";var r,n={exports:{}},o={};var a,i={};n.exports="production"==={}.NODE_ENV?function(){if(r)return o;r=1;var t=e,n=Symbol.for("react.element"),a=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,s=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,r){var o,a={},l=null,u=null;for(o in void 0!==r&&(l=""+r),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)i.call(t,o)&&!c.hasOwnProperty(o)&&(a[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===a[o]&&(a[o]=t[o]);return{$$typeof:n,type:e,key:l,ref:u,props:a,_owner:s.current}}return o.Fragment=a,o.jsx=l,o.jsxs=l,o}():(a||(a=1,
/**
     * @license React
     * react-jsx-runtime.development.js
     *
     * Copyright (c) Facebook, Inc. and its affiliates.
     *
     * This source code is licensed under the MIT license found in the
     * LICENSE file in the root directory of this source tree.
     */
"production"!=={}.NODE_ENV&&function(){var t,r=e,n=Symbol.for("react.element"),o=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),u=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),y=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.for("react.offscreen"),b=Symbol.iterator,v=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function h(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];!function(e,t,r){var n=v.ReactDebugCurrentFrame.getStackAddendum();""!==n&&(t+="%s",r=r.concat([n]));var o=r.map(function(e){return String(e)});o.unshift("Warning: "+t),Function.prototype.apply.call(console[e],console,o)}("error",e,r)}function w(e){return e.displayName||"Context"}function _(e){if(null==e)return null;if("number"==typeof e.tag&&h("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),"function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case a:return"Fragment";case o:return"Portal";case c:return"Profiler";case s:return"StrictMode";case p:return"Suspense";case d:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case u:return w(e)+".Consumer";case l:return w(e._context)+".Provider";case f:return function(e,t,r){var n=e.displayName;if(n)return n;var o=t.displayName||t.name||"";return""!==o?r+"("+o+")":r}(e,e.render,"ForwardRef");case y:var t=e.displayName||null;return null!==t?t:_(e.type)||"Memo";case m:var r=e,n=r._payload,i=r._init;try{return _(i(n))}catch(g){return null}}return null}t=Symbol.for("react.module.reference");var x,j,k,E,S,O,N,R=Object.assign,T=0;function C(){}C.__reactDisabledLog=!0;var P,I=v.ReactCurrentDispatcher;function $(e,t,r){if(void 0===P)try{throw Error()}catch(o){var n=o.stack.trim().match(/\n( *(at )?)/);P=n&&n[1]||""}return"\n"+P+e}var D,F=!1,A="function"==typeof WeakMap?WeakMap:Map;function U(e,t){if(!e||F)return"";var r,n=D.get(e);if(void 0!==n)return n;F=!0;var o,a=Error.prepareStackTrace;Error.prepareStackTrace=void 0,o=I.current,I.current=null,function(){if(0===T){x=console.log,j=console.info,k=console.warn,E=console.error,S=console.group,O=console.groupCollapsed,N=console.groupEnd;var e={configurable:!0,enumerable:!0,value:C,writable:!0};Object.defineProperties(console,{info:e,log:e,warn:e,error:e,group:e,groupCollapsed:e,groupEnd:e})}T++}();try{if(t){var i=function(){throw Error()};if(Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(i,[])}catch(y){r=y}Reflect.construct(e,[],i)}else{try{i.call()}catch(y){r=y}e.call(i.prototype)}}else{try{throw Error()}catch(y){r=y}e()}}catch(m){if(m&&r&&"string"==typeof m.stack){for(var s=m.stack.split("\n"),c=r.stack.split("\n"),l=s.length-1,u=c.length-1;l>=1&&u>=0&&s[l]!==c[u];)u--;for(;l>=1&&u>=0;l--,u--)if(s[l]!==c[u]){if(1!==l||1!==u)do{if(l--,--u<0||s[l]!==c[u]){var f="\n"+s[l].replace(" at new "," at ");return e.displayName&&f.includes("<anonymous>")&&(f=f.replace("<anonymous>",e.displayName)),"function"==typeof e&&D.set(e,f),f}}while(l>=1&&u>=0);break}}}finally{F=!1,I.current=o,function(){if(0===--T){var e={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:R({},e,{value:x}),info:R({},e,{value:j}),warn:R({},e,{value:k}),error:R({},e,{value:E}),group:R({},e,{value:S}),groupCollapsed:R({},e,{value:O}),groupEnd:R({},e,{value:N})})}T<0&&h("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}(),Error.prepareStackTrace=a}var p=e?e.displayName||e.name:"",d=p?$(p):"";return"function"==typeof e&&D.set(e,d),d}function M(e,t,r){if(null==e)return"";if("function"==typeof e)return U(e,!(!(n=e.prototype)||!n.isReactComponent));var n;if("string"==typeof e)return $(e);switch(e){case p:return $("Suspense");case d:return $("SuspenseList")}if("object"==typeof e)switch(e.$$typeof){case f:return U(e.render,!1);case y:return M(e.type,t,r);case m:var o=e,a=o._payload,i=o._init;try{return M(i(a),t,r)}catch(s){}}return""}D=new A;var L=Object.prototype.hasOwnProperty,W={},q=v.ReactDebugCurrentFrame;function z(e){if(e){var t=e._owner,r=M(e.type,e._source,t?t.type:null);q.setExtraStackFrame(r)}else q.setExtraStackFrame(null)}var B=Array.isArray;function Y(e){return B(e)}function V(e){return""+e}function H(e){if(function(e){try{return V(e),!1}catch(t){return!0}}(e))return h("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",function(e){return"function"==typeof Symbol&&Symbol.toStringTag&&e[Symbol.toStringTag]||e.constructor.name||"Object"}(e)),V(e)}var J,K,X=v.ReactCurrentOwner,G={key:!0,ref:!0,__self:!0,__source:!0};function Q(e,t,r,o,a){var i,s={},c=null,l=null;for(i in void 0!==r&&(H(r),c=""+r),function(e){if(L.call(e,"key")){var t=Object.getOwnPropertyDescriptor(e,"key").get;if(t&&t.isReactWarning)return!1}return void 0!==e.key}(t)&&(H(t.key),c=""+t.key),function(e){if(L.call(e,"ref")){var t=Object.getOwnPropertyDescriptor(e,"ref").get;if(t&&t.isReactWarning)return!1}return void 0!==e.ref}(t)&&(l=t.ref,function(e){"string"==typeof e.ref&&X.current}(t)),t)L.call(t,i)&&!G.hasOwnProperty(i)&&(s[i]=t[i]);if(e&&e.defaultProps){var u=e.defaultProps;for(i in u)void 0===s[i]&&(s[i]=u[i])}if(c||l){var f="function"==typeof e?e.displayName||e.name||"Unknown":e;c&&function(e,t){var r=function(){J||(J=!0,h("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",t))};r.isReactWarning=!0,Object.defineProperty(e,"key",{get:r,configurable:!0})}(s,f),l&&function(e,t){var r=function(){K||(K=!0,h("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",t))};r.isReactWarning=!0,Object.defineProperty(e,"ref",{get:r,configurable:!0})}(s,f)}return function(e,t,r,o,a,i,s){var c={$$typeof:n,type:e,key:t,ref:r,props:s,_owner:i,_store:{}};return Object.defineProperty(c._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(c,"_self",{configurable:!1,enumerable:!1,writable:!1,value:o}),Object.defineProperty(c,"_source",{configurable:!1,enumerable:!1,writable:!1,value:a}),Object.freeze&&(Object.freeze(c.props),Object.freeze(c)),c}(e,c,l,a,o,X.current,s)}var Z,ee=v.ReactCurrentOwner,te=v.ReactDebugCurrentFrame;function re(e){if(e){var t=e._owner,r=M(e.type,e._source,t?t.type:null);te.setExtraStackFrame(r)}else te.setExtraStackFrame(null)}function ne(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}function oe(){if(ee.current){var e=_(ee.current.type);if(e)return"\n\nCheck the render method of `"+e+"`."}return""}Z=!1;var ae={};function ie(e,t){if(e._store&&!e._store.validated&&null==e.key){e._store.validated=!0;var r=function(e){var t=oe();if(!t){var r="string"==typeof e?e:e.displayName||e.name;r&&(t="\n\nCheck the top-level render call using <"+r+">.")}return t}(t);if(!ae[r]){ae[r]=!0;var n="";e&&e._owner&&e._owner!==ee.current&&(n=" It was passed a child from "+_(e._owner.type)+"."),re(e),h('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',r,n),re(null)}}}function se(e,t){if("object"==typeof e)if(Y(e))for(var r=0;r<e.length;r++){var n=e[r];ne(n)&&ie(n,t)}else if(ne(e))e._store&&(e._store.validated=!0);else if(e){var o=function(e){if(null===e||"object"!=typeof e)return null;var t=b&&e[b]||e["@@iterator"];return"function"==typeof t?t:null}(e);if("function"==typeof o&&o!==e.entries)for(var a,i=o.call(e);!(a=i.next()).done;)ne(a.value)&&ie(a.value,t)}}function ce(e){var t,r=e.type;if(null!=r&&"string"!=typeof r){if("function"==typeof r)t=r.propTypes;else{if("object"!=typeof r||r.$$typeof!==f&&r.$$typeof!==y)return;t=r.propTypes}if(t){var n=_(r);!function(e,t,r,n,o){var a=Function.call.bind(L);for(var i in e)if(a(e,i)){var s=void 0;try{if("function"!=typeof e[i]){var c=Error((n||"React class")+": "+r+" type `"+i+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof e[i]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw c.name="Invariant Violation",c}s=e[i](t,i,n,r,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(l){s=l}!s||s instanceof Error||(z(o),h("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",n||"React class",r,i,typeof s),z(null)),s instanceof Error&&!(s.message in W)&&(W[s.message]=!0,z(o),h("Failed %s type: %s",r,s.message),z(null))}}(t,e.props,"prop",n,e)}else void 0===r.PropTypes||Z||(Z=!0,h("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",_(r)||"Unknown"));"function"!=typeof r.getDefaultProps||r.getDefaultProps.isReactClassApproved||h("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}var le={};function ue(e,r,o,i,b,v){var w=function(e){return"string"==typeof e||"function"==typeof e||e===a||e===c||e===s||e===p||e===d||e===g||"object"==typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===y||e.$$typeof===l||e.$$typeof===u||e.$$typeof===f||e.$$typeof===t||void 0!==e.getModuleId)}(e);if(!w){var x,j="";(void 0===e||"object"==typeof e&&null!==e&&0===Object.keys(e).length)&&(j+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports."),j+=oe(),null===e?x="null":Y(e)?x="array":void 0!==e&&e.$$typeof===n?(x="<"+(_(e.type)||"Unknown")+" />",j=" Did you accidentally export a JSX literal instead of a component?"):x=typeof e,h("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",x,j)}var k=Q(e,r,o,b,v);if(null==k)return k;if(w){var E=r.children;if(void 0!==E)if(i)if(Y(E)){for(var S=0;S<E.length;S++)se(E[S],e);Object.freeze&&Object.freeze(E)}else h("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else se(E,e)}if(L.call(r,"key")){var O=_(e),N=Object.keys(r).filter(function(e){return"key"!==e}),R=N.length>0?"{key: someKey, "+N.join(": ..., ")+": ...}":"{key: someKey}";le[O+R]||(h('A props object containing a "key" prop is being spread into JSX:\n  let props = %s;\n  <%s {...props} />\nReact keys must be passed directly to JSX without using spread:\n  let props = %s;\n  <%s key={someKey} {...props} />',R,O,N.length>0?"{"+N.join(": ..., ")+": ...}":"{}",O),le[O+R]=!0)}return e===a?function(e){for(var t=Object.keys(e.props),r=0;r<t.length;r++){var n=t[r];if("children"!==n&&"key"!==n){re(e),h("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",n),re(null);break}}null!==e.ref&&(re(e),h("Invalid attribute `ref` supplied to `React.Fragment`."),re(null))}(k):ce(k),k}var fe=function(e,t,r){return ue(e,t,r,!1)},pe=function(e,t,r){return ue(e,t,r,!0)};i.Fragment=a,i.jsx=fe,i.jsxs=pe}()),i);var s=n.exports,c={},l=t;if("production"==={}.NODE_ENV)c.createRoot=l.createRoot,c.hydrateRoot=l.hydrateRoot;else{var u=l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;c.createRoot=function(e,t){u.usingClientEntryPoint=!0;try{return l.createRoot(e,t)}finally{u.usingClientEntryPoint=!1}},c.hydrateRoot=function(e,t,r){u.usingClientEntryPoint=!0;try{return l.hydrateRoot(e,t,r)}finally{u.usingClientEntryPoint=!1}}}class f{constructor(e){this.apiUrl=e.apiUrl,this.businessId=e.businessId}async sendMessage(e){try{const t=await fetch(`${this.apiUrl}/nnia/respond`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e,clientId:this.businessId,source:"widget"})});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return await t.json()}catch(t){throw console.error("Error al enviar mensaje a NNIA:",t),t}}async getWidgetConfig(e){try{const t=await fetch(`${this.apiUrl}/nnia/widget/config/${e}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return await t.json()}catch(t){throw console.error("Error al obtener configuración del widget:",t),t}}}const p=({config:t})=>{const[r,n]=e.useState([{id:1,sender:"assistant",text:(null==t?void 0:t.welcomeMessage)||"¡Hola! Soy NNIA, tu asistente virtual. ¿En qué puedo ayudarte?"}]),[o,a]=e.useState(""),[i,c]=e.useState(!1),l=e.useRef(null),u=new f(t);e.useEffect(()=>{var e;null==(e=l.current)||e.scrollIntoView({behavior:"smooth"})},[r]);return s.jsxs("div",{className:"nnia-widget-card bg-white rounded-xl shadow-lg p-4 w-80 max-w-full slide-in",style:{fontFamily:"inherit"},children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold",children:"N"}),s.jsx("span",{className:"font-semibold text-lg",children:"NNIA"})]}),s.jsxs("div",{className:"flex flex-col h-64 custom-scrollbar overflow-y-auto mb-2",children:[r.map(e=>s.jsx("div",{className:`flex ${"user"===e.sender?"justify-end":"justify-start"} mb-1`,children:s.jsx("div",{className:"rounded-2xl px-4 py-2 max-w-[80%] break-words shadow-sm text-sm "+("user"===e.sender?"bg-blue-500 text-white rounded-br-md":"bg-gray-100 text-gray-900 rounded-bl-md"),children:e.text})},e.id)),i&&s.jsx("div",{className:"flex justify-start",children:s.jsx("div",{className:"bg-gray-100 text-gray-900 rounded-2xl px-4 py-2 max-w-[80%] shadow-sm opacity-70 text-sm",children:"NNIA está escribiendo..."})}),s.jsx("div",{ref:l})]}),s.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),""===o.trim())return;const t={id:Date.now(),sender:"user",text:o};n(e=>[...e,t]),c(!0);try{const e=await u.sendMessage(o);n(t=>[...t,{id:Date.now()+1,sender:"assistant",text:e.nnia||"No se recibió respuesta de NNIA."}])}catch(r){n(e=>[...e,{id:Date.now()+2,sender:"assistant",text:"Ocurrió un error al conectar con NNIA."}])}finally{c(!1),a("")}},className:"flex gap-2",children:[s.jsx("input",{type:"text",placeholder:"Escribe un mensaje...",value:o,onChange:e=>a(e.target.value),className:"flex-1 border rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",autoComplete:"off"}),s.jsx("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-600 text-white rounded-lg px-3 py-2 text-sm font-semibold",disabled:i,children:"Enviar"})]})]})};function d(t={}){if(document.getElementById("nnia-widget-container"))return;const r=document.createElement("div");return r.id="nnia-widget-container",document.body.appendChild(r),c.createRoot(r).render(s.jsx(e.StrictMode,{children:s.jsx(p,{config:t})})),{destroy:()=>{const e=document.getElementById("nnia-widget-container");e&&(c.unmountComponentAtNode(e),e.remove())}}}"undefined"!=typeof window&&(window.initNNIAWidget=d,function(){if("undefined"==typeof window)return;const e=document.querySelectorAll('script[src*="nnia-widget.umd.js"]');if(!e.length)return;const t=e[e.length-1];if(!t.dataset.businessId||!t.dataset.apiUrl)return;d({businessId:t.dataset.businessId,apiUrl:t.dataset.apiUrl,position:t.dataset.position||"bottom-right",theme:{primaryColor:t.dataset.primaryColor||"#3b82f6",backgroundColor:t.dataset.backgroundColor||"#ffffff",textColor:t.dataset.textColor||"#1f2937"},welcomeMessage:t.dataset.welcomeMessage||"¡Hola! Soy NNIA, tu asistente virtual. ¿En qué puedo ayudarte?",autoOpen:"true"===t.dataset.autoOpen,showTimestamp:"false"!==t.dataset.showTimestamp,maxMessages:parseInt(t.dataset.maxMessages)||50})}())});
